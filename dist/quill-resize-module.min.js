!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).QuillResizeModule=e()}(this,function(){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};var a=function(){return(a=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},n=(t.prototype.findLabel=function(t){return this.config?Reflect.get(this.config,t):null},t);function t(t){this.config=a(a({},o),t)}var o={altTip:"按住alt键比例缩放",floatLeft:"靠左",floatRight:"靠右",center:"居中",restore:"还原"};var e,s,r;e=HTMLElement,i(s=h,r=e),s.prototype=null===r?Object.create(r):(l.prototype=r.prototype,new l);function l(){this.constructor=s}function h(){var t=null!==e&&e.apply(this,arguments)||this;return t.originSize=null,t}var c=(d.prototype.initResizer=function(){var t=this.container.querySelector("#editor-resizer");t||((t=document.createElement("div")).setAttribute("id","editor-resizer"),t.innerHTML=function(t){for(var i=[],e=1;e<arguments.length;e++)i[e-1]=arguments[e];return t.replace(/\{(\d+)\}/g,function(t,e){return i.length>e?i[e]:""})}('\n<div class="handler" title="{0}"></div>\n<div class="toolbar">\n  <div class="btn-group">\n    <a class="btn btn-white" data-width="100%">100%</a>\n    <a class="btn btn-white" data-width="50%">50%</a>\n    <a class="btn btn-white btn-icon"data-width="-5" class="btn btn-white btn-icon inner-btn">\n         <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-minus" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">\n           <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>\n           <line x1="5" y1="12" x2="19" y2="12"></line>\n        </svg>\n    </a>\n    <a class="btn btn-white btn-icon"ata-width="5" class="btn btn-white btn-icon inner-btn">\n         <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-plus" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">\n           <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>\n           <line x1="12" y1="5" x2="12" y2="19"></line>\n           <line x1="5" y1="12" x2="19" y2="12"></line>\n        </svg>\n    </a>\n    <a class="btn btn-white btn-icon" data-float="left">\n        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-align-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">\n         <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>\n         <line x1="4" y1="6" x2="20" y2="6"></line>\n         <line x1="4" y1="12" x2="14" y2="12"></line>\n         <line x1="4" y1="18" x2="18" y2="18"></line>\n      </svg>\n    </a>\n    <a class="btn btn-white btn-icon" data-float="center">\n        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-align-center" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">\n           <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>\n           <line x1="4" y1="6" x2="20" y2="6"></line>\n           <line x1="8" y1="12" x2="16" y2="12"></line>\n           <line x1="6" y1="18" x2="18" y2="18"></line>\n        </svg>    \n    </a>\n    <a class="btn btn-white btn-icon" data-float="right">\n        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-align-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">\n           <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>\n           <line x1="4" y1="6" x2="20" y2="6"></line>\n           <line x1="10" y1="12" x2="20" y2="12"></line>\n           <line x1="6" y1="18" x2="20" y2="18"></line>\n        </svg>\n    </a>\n    <a data-float="none" class="btn btn-white btn-icon">\n        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">\n           <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>\n           <line x1="18" y1="6" x2="6" y2="18"></line>\n           <line x1="6" y1="6" x2="18" y2="18"></line>\n        </svg>    \n    </a>\n  </div>\n</div>\n',this.i18n.findLabel("altTip"),this.i18n.findLabel("floatLeft"),this.i18n.findLabel("center"),this.i18n.findLabel("floatRight"),this.i18n.findLabel("restore")),this.container.appendChild(t)),this.resizer=t},d.prototype.positionResizerToTarget=function(t){null!==this.resizer&&(this.resizer.style.setProperty("left",t.offsetLeft+"px"),this.resizer.style.setProperty("top",t.offsetTop+"px"),this.resizer.style.setProperty("width",t.clientWidth+"px"),this.resizer.style.setProperty("height",t.clientHeight+"px"))},d.prototype.bindEvents=function(){null!==this.resizer&&(this.resizer.addEventListener("mousedown",this.startResize),this.resizer.addEventListener("click",this.toolbarClick)),window.addEventListener("mouseup",this.endResize),window.addEventListener("mousemove",this.resizing)},d.prototype.toolbarClick=function(t){var e,i=t.target;if(i.classList.contains("btn")||i.classList.contains("inner-btn")){var n=i.dataset.width,o=i.dataset.float,s=this.resizeTarget.style;if(n)if("iframe"!==this.resizeTarget.tagName.toLowerCase()&&s.removeProperty("height"),"auto"===n)s.removeProperty("width");else if(n.includes("%"))s.setProperty("width",n);else{var r=s.getPropertyValue("width");n=parseInt(n),r=r.includes("%")?Math.min(Math.max(parseInt(r)+n,5),100)+"%":Math.max(this.resizeTarget.clientWidth+n,10)+"px",s.setProperty("width",r)}else"center"===o?(s.setProperty("display","block"),s.setProperty("margin","auto"),s.removeProperty("float")):(s.removeProperty("display"),s.removeProperty("margin"),s.setProperty("float",o));this.positionResizerToTarget(this.resizeTarget),null!==(e=this.options)&&void 0!==e&&e.onChange(this.resizeTarget)}},d.prototype.startResize=function(t){t.target.classList.contains("handler")&&1===t.which&&(this.startResizePosition={left:t.clientX,top:t.clientY,width:this.resizeTarget.clientWidth,height:this.resizeTarget.clientHeight})},d.prototype.endResize=function(){var t;(this.startResizePosition=null)!==(t=this.options)&&void 0!==t&&t.onChange(this.resizeTarget)},d.prototype.resizing=function(t){if(this.startResizePosition){var e=t.clientX-this.startResizePosition.left,i=t.clientY-this.startResizePosition.top,n=this.startResizePosition.width,o=this.startResizePosition.height;if(n+=e,o+=i,t.altKey||this.options.ratioLock){var s=this.resizeTarget.originSize;o=s.height/s.width*n}this.resizeTarget.style.setProperty("width",Math.max(n,30)+"px"),this.resizeTarget.style.setProperty("height",Math.max(o,30)+"px"),this.positionResizerToTarget(this.resizeTarget)}},d.prototype.destory=function(){this.container.removeChild(this.resizer),window.removeEventListener("mouseup",this.endResize),window.removeEventListener("mousemove",this.resizing),this.resizer=null},d);function d(t,e,i){this.resizer=null,this.startResizePosition=null,this.i18n=new n((null==i?void 0:i.locale)||o),this.options=i,(this.resizeTarget=t).originSize||(t.originSize={width:t.clientWidth,height:t.clientHeight}),this.container=e,this.initResizer(),this.positionResizerToTarget(t),this.resizing=this.resizing.bind(this),this.endResize=this.endResize.bind(this),this.startResize=this.startResize.bind(this),this.toolbarClick=this.toolbarClick.bind(this),this.bindEvents()}var p=function(t,e){this.element=t,this.cb=e,this.hasTracked=!1},u=(f.track=function(t,e){this.iframes.push(new p(t,e)),this.interval||(this.interval=setInterval(function(){f.checkClick()},this.resolution))},f.checkClick=function(){if(document.activeElement){var t=document.activeElement;for(var e in this.iframes)t===this.iframes[e].element?0==this.iframes[e].hasTracked&&(this.iframes[e].cb.apply(window,[]),this.iframes[e].hasTracked=!0):this.iframes[e].hasTracked=!1}},f.resolution=200,f.iframes=[],f.interval=null,f);function f(){}return function(e,i){var s,r,n=e.root;function o(){var t=(new(e.getContents().constructor)).retain(1);e.updateContents(t)}n.addEventListener("click",function(t){var e=t.target;t.target&&["img","video"].includes(e.tagName.toLowerCase())&&(r=new c(s=e,n.parentElement,a(a({},i),{onChange:o})))}),e.on("text-change",function(t,e){n.querySelectorAll("iframe").forEach(function(t){u.track(t,function(){r=new c(s=t,n.parentElement,a(a({},i),{onChange:o}))})})}),document.addEventListener("mousedown",function(t){var e,i,n,o=t.target;o===s||null!==(i=null===(e=null==r?void 0:r.resizer)||void 0===e?void 0:e.contains)&&void 0!==i&&i.call(e,o)||(null!==(n=null==r?void 0:r.destory)&&void 0!==n&&n.call(r),s=r=null)},{capture:!0})}});
